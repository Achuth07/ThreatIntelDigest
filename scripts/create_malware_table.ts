
import { getDb } from '../server/db';
import { sql } from 'drizzle-orm';
import * as dotenv from 'dotenv';
dotenv.config();

async function createMalwareTable() {
  const db = getDb();

  console.log("Creating malware_daily_stats table...");

  try {
    await db.execute(sql`
      CREATE TABLE IF NOT EXISTS malware_daily_stats (
        id SERIAL PRIMARY KEY,
        date TIMESTAMP DEFAULT CURRENT_DATE,
        family_name VARCHAR(100),
        sample_count INTEGER,
        malware_type VARCHAR(50),
        created_at TIMESTAMP DEFAULT NOW()
      );
    `);
    console.log("Table created successfully.");
  } catch (error) {
    console.error("Error creating table:", error);
  }

  process.exit(0);
}

createMalwareTable();
